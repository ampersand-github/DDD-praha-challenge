# READ ME
DDD

## 動作確認

##### 毎回必要
###### Docker
```zsh
cd db
docker-compose up -d
```

##### 初回、もしくは必要に応じて
###### モデルのマイグレーション
`schema.prisma`を修正後、以下を実施  
`npm run db:migration:model`
###### シード値のマイグレーション
`npm run db:migration:seed`

##### Nest.jsを使用する場合
##### `npm run start:debug`


## ここでやること
##### 複数集約間の整合性を確保する方法はすべてドメインサービスとする
ユースケース層に記述する方法とドメインサービスに記述する方法の２種類あるが、  
今回はすべてドメインサービスに寄せる。  
仕様の可読性向上を理由とする  
[DDDで複数集約間の整合性を確保する方法(サンプルコードあり)[ドメイン駆動設計] - little hands' lab](https://little-hands.hatenablog.com/entry/2021/03/08/aggregation)
##### DBにはロジックを持たせない
トリガー、カスケードなどは使わない。  
外部キーやユニークキーなどはOK
## ここでやらないこと
##### 各エンティティごとに独自のID型を持つこと
エンティティのidがすべてがUUIDv4とは限らないので、
エンティティに共通するUUIDv4を提供する共通クラスは作るべきではないが、
今回はエンティティのidをすべてUUIDv4にしているので、
各エンティティごとに独自のID型を持たせないことにする。
##### リポジトリのテストをInMemory上で行うこと
リポジトリのテストは実際にテストDBを持ってやりたい。
外部キーの成約とかあるので。
(予定)
